# ORW

## Description

Read the flag from /home/orw/flag.

Only open read write syscall are allowed to use.

nc chall.pwnable.tw 10001

[orw](https://pwnable.tw/static/chall/orw)

## Solution

kiểm tra bin

<img src="https://imgur.com/lWQBqeD.png">


như ta thấy file yêu cầu chúng ta nhập shellcode trong đó chỉ có open, read, write được cho phép
vậy yêu cầu như thế này đơn giản là:

open flag, read flag, write flag

bài này test khả năng viết shell của chúng ta

đầu tiên là **sys_open()**

-	eax == 0x5
-	ebx == filename, cái này chúng ta sẽ push file vào stack cho ebx == esp
-	ecx == access mode. read-only(0), write-only(1), read-write(2). Vì ta chỉ cần read nên 0 là được
-	edx == file permission. Không quan trọng nên null
-	sys_open trả về giá trị lưu vào eax

tiếp đến là **sys_read()**

-	eax == 0x3
-	ebx == file descriptor của file cần read. mà file cần read đã được lưu trên thanh eax của hàm trên nên ebx == eax
-	ecx == con trỏ đến thanh ghi chứa chuỗi đọc được, chọn bừa esi
-	edx == số byte cần đọc. cho đại 0x50
-	sys_read trả về số kí tự đọc được trong file, lưu vào eax

cuối cùng là **sys_write()**

-	eax == 0x4
-	ebx == file descriptor. vì cần in ra stdout nên ebx == 0x1
-	ecx == trỏ vào thanh ghi chứa chuỗi cần ghi. như ta dùng thanh esi thì ecx == esi
-	edx == số kí tự cần đọc chính là giá trị trả về của sys_read edx == eax

*payload*

<img src="https://imgur.com/DfVQF7q.png">

<img src="https://imgur.com/MXCNHde.png">