# ELF x86 - Format string bug basic 1
## 1. Source code

```c
#include <stdio.h>
#include <unistd.h>
 
int main(int argc, char *argv[]){
        FILE *secret = fopen("/challenge/app-systeme/ch5/.passwd", "rt");
        char buffer[32];
        fgets(buffer, sizeof(buffer), secret);
        printf(argv[1]);
        fclose(secret);
        return 0;
}
```

## 2. Solution

đây là 1 kĩ thuật exploit dựa vào lỗi format string (google để biết thêm thông tin chi tiết)
- để exploit được lỗi này ta hãy hiểu được code trước

```c
	FILE *secret = fopen("/challenge/app-systeme/ch5/.passwd", "rt");
	char buffer[32];
	fgets(buffer, sizeof(buffer), secret);
```
> chương trình lúc này open 1 file có tên là `.passwd` rồi lưu nó vào trong stack của chương trình, 
> source cho chúng ta thấy được rằng flag của chương trình lúc này sẽ được gán vào giá trị của biến buf
***
> ta thấy được đoạn code sau dẫn đến lỗi fmt

```c
		printf(argv[1]);
```
> vậy lúc này công việc của chúng ta sẽ dùng lỗi fmt để leak giá trị của `.passwd`
- bây giờ kiểm tra lỗi format string

<img src="https://i.imgur.com/NpX6zm9.png">

- lúc này ta sẽ leak ra toàn bộ giá trị của buffer

<img src="https://i.imgur.com/FO2mW6Z.png">

- ta sẽ đổi các giá trị trên memory thành ký tự ascii

<img src="https://i.imgur.com/ldaAWqf.png">

- ta thấy rằng giá trị cần tìm là `9apD()6dmapE`, nhưng thực chất ta cần phải đổi các kí tự kia theo Little endian (vì hệ intel dùng LE) mỗi 4 byte (32bits) là ta có được flag

<details>
	<summary>FLAG</summary>
	Dpa9d6)(Epam
</details>