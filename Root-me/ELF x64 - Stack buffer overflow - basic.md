# ELF x64 - Stack buffer overflow - basic
## 1. Source code
```c
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>
 
/*
gcc -o ch35 ch35.c -fno-stack-protector -no-pie -Wl,-z,relro,-z,now,-z,noexecstack
*/
 
void callMeMaybe(){
    char *argv[] = { "/bin/bash", "-p", NULL };
    execve(argv[0], argv, NULL);
}
 
int main(int argc, char **argv){
 
    char buffer[256];
    int len, i;
 
    scanf("%s", buffer);
    len = strlen(buffer);
 
    printf("Hello %s\n", buffer);
 
    return 0;
}
```

## 2. Solution

như đã nói từ chal trước, thì việc đầu tiên của chúng ta đó chính là tìm offset của biến buf sau đó overflow ret addr thành địa chỉ của hàm `callMeMayBe` . vì đây là x64 nên base addr sẽ là 8 bytes

- disassemble hàm main

<img src="https://i.imgur.com/3NSdhxI.png">

- ta thấy được offset của buffer là 272(0x110)
- vậy payload của ta bao gồm

`(272 junks + 8 junks + địa chỉ callMe ; cat) | ./ch35`

- địa chỉ của `callMe` = 0x00000000004005e7

<img src="https://i.imgur.com/Hbfdsd1.png">
