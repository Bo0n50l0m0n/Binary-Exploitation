# ELF x86 - Stack buffer overflow basic 2
## 1. Source code

```c
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>
 
void shell() {
    setreuid(geteuid(), geteuid());
    system("/bin/bash");
}
 
void sup() {
    printf("Hey dude ! Waaaaazzaaaaaaaa ?!\n");
}
 
void main()
{
    int var;
    void (*func)()=sup;
    char buf[128];
    fgets(buf,133,stdin);
    func();
}
```

## 2. Solution

giống như challenge trước, ta thấy

```c
    void (*func)()=sup;
    char buf[128];
    fgets(buf,133,stdin);
```

hàm `fgets` dùng để giới hạn số byte mà biến buf được nhận vào, 133 là vì nó tính thêm `\0` (null byte)

- việc của ta bây giờ chính là overflow pointer func(đang trỏ vào hàm sup)
- kế đến là việc tìm địa chỉ Global Offset Table (GOT) của hàm `shell`
>> có nhiều cách, thông dụng nhất là `objdump -x [binary]`

 <img src="https://i.imgur.com/TyEHfRN.png">

- kết hợp với kỹ thuật `cat` đã nói qua chal trước thì bây giờ payload của ta sẽ thành

>> `128 bytes junk + \x16\x85\x04\x08`

<img src="https://i.imgur.com/pWQCGav.png">

-cat flag

<img src="https://i.imgur.com/v9fBxEb.png">

<details>
  <summary>FLAG</summary>
  B33r1sSoG0oD4y0urBr4iN
</details>
